<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Enrollment Form - {{ $enrollment->surname }}, {{ $enrollment->first_name }}</title>
    <style>
        @page {
            margin: 15mm 15mm 15mm 15mm;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', 'Helvetica', sans-serif;
            font-size: 9pt;
            line-height: 1.4;
            color: #000;
            background: #fff;
        }

        /* Modern header with official government look */
        .header {
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(to bottom, #f8f9fa 0%, #ffffff 100%);
            border: 2px solid #1a5f3f;
            border-radius: 3px;
        }

        .header-table {
            width: 100%;
            border-collapse: collapse;
        }

        .header-table td {
            vertical-align: top;
            padding: 0;
        }

        .logo-and-text {
            display: table;
            width: 100%;
        }

        .logo-cell {
            display: table-cell;
            width: 80px;
            padding-right: 15px;
            vertical-align: top;
        }

        .text-cell {
            display: table-cell;
            vertical-align: top;
        }

        .logo-placeholder {
            width: 80px;
            height: 80px;
            border: 2px dashed #1a5f3f;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            border-radius: 2px;
        }

        .logo-placeholder-text {
            font-size: 8pt;
            color: #1a5f3f;
            text-align: center;
            font-weight: 600;
            padding: 5px;
        }

        .header-text {
            text-align: left;
            flex: 1;
        }

        .header-logo {
            font-size: 9pt;
            color: #1a5f3f;
            font-weight: bold;
            margin-bottom: 3px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .header h1 {
            font-size: 14pt;
            color: #1a5f3f;
            margin: 5px 0;
            font-weight: bold;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            line-height: 1.2;
        }

        .header .subtitle {
            font-size: 9pt;
            color: #333;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .header .form-type {
            font-size: 8.5pt;
            color: #666;
            font-style: italic;
            margin-top: 3px;
        }

        .rsbsa-no {
            display: inline-block;
        }

        .rsbsa-badge {
            background: #1a5f3f;
            color: white;
            padding: 8px 12px;
            font-size: 9pt;
            font-weight: bold;
            border-radius: 2px;
            letter-spacing: 0.5px;
            border: 1px solid #0f4a2f;
            display: inline-block;
        }

        .photo-container {
            text-align: center;
            flex-shrink: 0;
        }

        .photo {
            width: 144px;
            /* 1.5 inches at 96 DPI */
            height: 144px;
            /* 1.5 inches at 96 DPI */
            object-fit: cover;
            border: 2px solid #1a5f3f;
            display: block;
            background: #f8f9fa;
        }

        .photo-placeholder {
            width: 144px;
            /* 1.5 inches at 96 DPI */
            height: 144px;
            /* 1.5 inches at 96 DPI */
            background: #f8f9fa;
            border: 2px dashed #ccc;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-size: 8pt;
            text-align: center;
            padding: 10px;
        }

        /* Form sections with box styling */
        .section {
            margin-bottom: 15px;
            page-break-inside: avoid;
            border: 1.5px solid #ddd;
            border-radius: 2px;
            overflow: hidden;
        }

        .section-title {
            background: #1a5f3f;
            color: white;
            padding: 6px 12px;
            font-size: 9.5pt;
            font-weight: bold;
            letter-spacing: 0.8px;
            text-transform: uppercase;
        }

        .section-content {
            padding: 12px;
            background: #fff;
        }

        /* Form field styling - looks like a fillable form */
        .form-row {
            margin-bottom: 8px;
            display: table;
            width: 100%;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 6px;
        }

        .form-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .form-label {
            display: table-cell;
            width: 140px;
            font-weight: 600;
            color: #333;
            font-size: 8.5pt;
            vertical-align: top;
            padding-right: 10px;
        }

        .form-value {
            display: table-cell;
            color: #000;
            font-size: 9pt;
            vertical-align: top;
            border-bottom: 1px dotted #ccc;
            padding-bottom: 2px;
        }

        .form-value-no-border {
            border-bottom: none;
        }

        /* Grid layout for multiple fields in one row */
        .form-grid {
            display: table;
            width: 100%;
            margin-bottom: 8px;
        }

        .form-grid-item {
            display: table-cell;
            padding-right: 15px;
        }

        .form-grid-item:last-child {
            padding-right: 0;
        }

        .form-grid-label {
            font-weight: 600;
            color: #333;
            font-size: 8pt;
            display: block;
            margin-bottom: 2px;
        }

        .form-grid-value {
            color: #000;
            font-size: 9pt;
            border-bottom: 1px dotted #ccc;
            padding-bottom: 2px;
            display: block;
            min-height: 16px;
        }

        /* Badge styling for tags */
        .badge {
            display: inline-block;
            padding: 3px 8px;
            background: #e8f5e9;
            color: #1b5e20;
            border: 1px solid #a5d6a7;
            border-radius: 2px;
            font-size: 8pt;
            font-weight: 600;
            margin-right: 4px;
            margin-bottom: 3px;
            white-space: nowrap;
        }

        .badge-primary {
            background: #e3f2fd;
            color: #0d47a1;
            border-color: #90caf9;
        }

        .badge-warning {
            background: #fff3e0;
            color: #e65100;
            border-color: #ffcc80;
        }

        .badge-success {
            background: #e8f5e9;
            color: #1b5e20;
            border-color: #a5d6a7;
        }

        /* Address block */
        .address-block {
            line-height: 1.5;
            color: #000;
            font-size: 9pt;
        }

        /* Income display */
        .income-grid {
            display: table;
            width: 100%;
        }

        .income-item {
            display: table-cell;
            width: 50%;
            padding: 8px;
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            text-align: center;
        }

        .income-item:first-child {
            border-right: none;
        }

        .income-label {
            font-weight: 600;
            color: #555;
            font-size: 8pt;
            display: block;
            margin-bottom: 3px;
            text-transform: uppercase;
        }

        .income-value {
            font-weight: bold;
            color: #1a5f3f;
            font-size: 11pt;
            display: block;
        }

        /* Parcel cards */
        .parcel-card {
            border: 1.5px solid #e0e0e0;
            margin-bottom: 12px;
            background: #fafafa;
            border-radius: 2px;
            page-break-inside: avoid;
        }

        .parcel-header {
            background: #f5f5f5;
            border-bottom: 1.5px solid #e0e0e0;
            padding: 8px 12px;
            font-weight: bold;
            color: #1a5f3f;
            font-size: 9pt;
        }

        .parcel-content {
            padding: 10px 12px;
        }

        .parcel-item {
            background: white;
            border-left: 3px solid #4caf50;
            padding: 8px 10px;
            margin: 8px 0;
            font-size: 8.5pt;
            border-radius: 1px;
        }

        .parcel-item strong {
            color: #1a5f3f;
            font-size: 9pt;
        }

        .parcel-item em {
            font-size: 8pt;
            color: #666;
            font-style: italic;
        }

        .parcel-meta {
            margin-top: 5px;
        }

        /* Footer */
        .footer {
            margin-top: 25px;
            padding-top: 12px;
            border-top: 2px solid #1a5f3f;
            text-align: center;
            font-size: 8pt;
            color: #666;
        }

        .footer strong {
            color: #1a5f3f;
            font-size: 9pt;
        }

        .footer p {
            margin: 3px 0;
        }

        /* Utility classes */
        .text-muted {
            color: #666;
        }

        .text-uppercase {
            text-transform: uppercase;
        }

        .text-center {
            text-align: center;
        }

        .mb-small {
            margin-bottom: 5px;
        }

        .clearfix::after {
            content: "";
            display: table;
            clear: both;
        }
    </style>
</head>

<body>
    <!-- Restructured header with table layout for PDF compatibility -->
    <div class="header">
        <table class="header-table">
            <tr>
                <td style="width: 75%;">
                    <div class="logo-and-text">
                        <div class="logo-cell">
                            <img src="{{ public_path('images/da-logo.png') }}" style="width: 80px; height: 80px; object-fit: contain;" alt="Logo">
                        </div>
                        <div class="text-cell">
                            <div class="header-text">
                                <div class="header-logo">Republic of the Philippines</div>
                                <h1>Registry System for Basic Sectors in Agriculture</h1>
                                <p class="subtitle">Department of Agriculture - Claveria, Cagayan</p>
                                <p class="form-type">Farmer/Fisherfolk Enrollment Form</p>
                                @if($enrollment->rsbsa_reference_number)
                                <div style="margin-top: 10px;">
                                    <div class="rsbsa-badge">
                                        RSBSA No: {{ $enrollment->rsbsa_reference_number }}
                                    </div>
                                </div>
                                @endif
                            </div>
                        </div>
                    </div>
                </td>
                <td style="width: 25%; text-align: center;">
                    <div class="photo-container">
                        @if($enrollment->photo_path)
                        <img src="{{ public_path('storage/' . $enrollment->photo_path) }}" class="photo" alt="Enrollee Photo">
                        @else
                        <div class="photo-placeholder">2x2 Photo<br>Not Available</div>
                        @endif
                    </div>
                </td>
            </tr>
        </table>
    </div>

    <!-- Personal Information Section -->
    <div class="section">
        <div class="section-title">I. Personal Information</div>
        <div class="section-content">
            <div class="form-row">
                <div class="form-label">Full Name:</div>
                <div class="form-value">{{ $enrollment->surname }}, {{ $enrollment->first_name }} {{
                    $enrollment->middle_name }} {{ $enrollment->extension_name }}</div>
            </div>

            <div class="form-grid">
                <div class="form-grid-item" style="width: 25%;">
                    <span class="form-grid-label">Sex:</span>
                    <span class="form-grid-value">{{ ucfirst($enrollment->sex) }}</span>
                </div>
                <div class="form-grid-item" style="width: 40%;">
                    <span class="form-grid-label">Date of Birth:</span>
                    <span class="form-grid-value">{{ $enrollment->date_of_birth ? $enrollment->date_of_birth->format('F
                        d, Y') : 'N/A' }}</span>
                </div>
                <div class="form-grid-item" style="width: 35%;">
                    <span class="form-grid-label">Place of Birth:</span>
                    <span class="form-grid-value">{{ $enrollment->place_of_birth ?? 'N/A' }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Address Section -->
    <div class="section">
        <div class="section-title">II. Address & Contact Information</div>
        <div class="section-content">
            <div class="form-row">
                <div class="form-label">Complete Address:</div>
                <div class="form-value form-value-no-border">
                    <div class="address-block">
                        {{ $enrollment->address_house_lot }} {{ $enrollment->address_street }}<br>
                        {{ $enrollment->address_barangay }}, {{ $enrollment->address_municipality_city }}<br>
                        {{ $enrollment->address_province }}, {{ $enrollment->address_region }}
                    </div>
                </div>
            </div>

            <div class="form-grid">
                <div class="form-grid-item" style="width: 50%;">
                    <span class="form-grid-label">Mobile Number:</span>
                    <span class="form-grid-value">{{ $enrollment->mobile_number ?? 'N/A' }}</span>
                </div>
                <div class="form-grid-item" style="width: 50%;">
                    <span class="form-grid-label">Landline:</span>
                    <span class="form-grid-value">{{ $enrollment->landline_number ?? 'N/A' }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Personal Details Section -->
    <div class="section">
        <div class="section-title">III. Personal Details</div>
        <div class="section-content">
            <div class="form-grid">
                <div class="form-grid-item" style="width: 50%;">
                    <span class="form-grid-label">Highest Formal Education:</span>
                    <span class="form-grid-value">{{ $enrollment->highest_formal_education ?? 'N/A' }}</span>
                </div>
                <div class="form-grid-item" style="width: 25%;">
                    <span class="form-grid-label">Religion:</span>
                    <span class="form-grid-value">{{ $enrollment->religion ?? 'N/A' }}</span>
                </div>
                <div class="form-grid-item" style="width: 25%;">
                    <span class="form-grid-label">Civil Status:</span>
                    <span class="form-grid-value">{{ ucfirst($enrollment->civil_status ?? 'N/A') }}</span>
                </div>
            </div>

            @if($enrollment->name_of_spouse)
            <div class="form-row">
                <div class="form-label">Spouse Name:</div>
                <div class="form-value">{{ $enrollment->name_of_spouse }}</div>
            </div>
            @endif

            <div class="form-row">
                <div class="form-label">Mother's Maiden Name:</div>
                <div class="form-value">{{ $enrollment->mothers_maiden_name ?? 'N/A' }}</div>
            </div>
        </div>
    </div>

    <!-- Household Information Section -->
    <div class="section">
        <div class="section-title">IV. Household Information</div>
        <div class="section-content">
            <div class="form-row">
                <div class="form-label">Household Head:</div>
                <div class="form-value form-value-no-border">
                    @if($enrollment->household_head)
                    <span class="badge badge-success">YES - This person is the household head</span>
                    @else
                    {{ $enrollment->household_head_name ?? 'N/A' }}
                    @if($enrollment->relationship_to_head)
                    ({{ $enrollment->relationship_to_head }})
                    @endif
                    @endif
                </div>
            </div>

            <div class="form-grid">
                <div class="form-grid-item" style="width: 33.33%;">
                    <span class="form-grid-label">Total Members:</span>
                    <span class="form-grid-value">{{ $enrollment->household_members_total }}</span>
                </div>
                <div class="form-grid-item" style="width: 33.33%;">
                    <span class="form-grid-label">Male:</span>
                    <span class="form-grid-value">{{ $enrollment->household_members_male }}</span>
                </div>
                <div class="form-grid-item" style="width: 33.33%;">
                    <span class="form-grid-label">Female:</span>
                    <span class="form-grid-value">{{ $enrollment->household_members_female }}</span>
                </div>
            </div>

            @if($enrollment->is_pwd || $enrollment->is_four_ps_beneficiary || $enrollment->is_indigenous_group_member)
            <div class="form-row">
                <div class="form-label">Special Status:</div>
                <div class="form-value form-value-no-border">
                    @if($enrollment->is_pwd) <span class="badge badge-primary">PWD</span> @endif
                    @if($enrollment->is_four_ps_beneficiary) <span class="badge badge-primary">4P's Beneficiary</span>
                    @endif
                    @if($enrollment->is_indigenous_group_member) <span class="badge badge-primary">{{
                        $enrollment->indigenous_group_specify }}</span> @endif
                </div>
            </div>
            @endif

            @if($enrollment->has_government_id)
            <div class="form-row">
                <div class="form-label">Government ID:</div>
                <div class="form-value">{{ $enrollment->government_id_type }} - {{ $enrollment->government_id_number }}
                </div>
            </div>
            @endif
        </div>
    </div>

    <!-- Emergency Contact Section -->
    <div class="section">
        <div class="section-title">V. Emergency Contact</div>
        <div class="section-content">
            <div class="form-grid">
                <div class="form-grid-item" style="width: 60%;">
                    <span class="form-grid-label">Contact Person:</span>
                    <span class="form-grid-value">{{ $enrollment->emergency_contact_name ?? 'N/A' }}</span>
                </div>
                <div class="form-grid-item" style="width: 40%;">
                    <span class="form-grid-label">Contact Number:</span>
                    <span class="form-grid-value">{{ $enrollment->emergency_contact_number ?? 'N/A' }}</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Livelihood & Farm Profile Section -->
    <div class="section">
        <div class="section-title">VI. Livelihood & Farm Profile</div>
        <div class="section-content">
            <div class="form-row">
                <div class="form-label">Main Livelihood:</div>
                <div class="form-value form-value-no-border">
                    <span class="badge badge-success text-uppercase">{{ str_replace('_', ' ',
                        $enrollment->main_livelihood) }}</span>
                </div>
            </div>

            @if($enrollment->main_livelihood === 'farmer')
            @if($enrollment->farming_activities && count($enrollment->farming_activities) > 0)
            <div class="form-row">
                <div class="form-label">Farming Activities:</div>
                <div class="form-value form-value-no-border">
                    @foreach($enrollment->farming_activities as $activity)
                    <span class="badge badge-warning">{{ ucfirst($activity) }}</span>
                    @endforeach
                </div>
            </div>
            @endif

            @if($enrollment->other_crop_specify)
            <div class="form-row">
                <div class="form-label">Other Crops:</div>
                <div class="form-value">{{ $enrollment->other_crop_specify }}</div>
            </div>
            @endif

            @if($enrollment->livestock_type_specify)
            <div class="form-row">
                <div class="form-label">Livestock Types:</div>
                <div class="form-value">{{ $enrollment->livestock_type_specify }}</div>
            </div>
            @endif

            @if($enrollment->poultry_type_specify)
            <div class="form-row">
                <div class="form-label">Poultry Types:</div>
                <div class="form-value">{{ $enrollment->poultry_type_specify }}</div>
            </div>
            @endif
            @endif

            <div style="margin-top: 10px;">
                <div style="font-weight: 600; color: #333; font-size: 8.5pt; margin-bottom: 5px;">Gross Annual Income:
                </div>
                <div class="income-grid">
                    <div class="income-item">
                        <span class="income-label">Farming Income</span>
                        <span class="income-value">₱{{ number_format($enrollment->gross_income_farming ?? 0, 2)
                            }}</span>
                    </div>
                    <div class="income-item">
                        <span class="income-label">Non-Farming Income</span>
                        <span class="income-value">₱{{ number_format($enrollment->gross_income_non_farming ?? 0, 2)
                            }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Farm Parcels Section -->
    @if($enrollment->farmParcels && $enrollment->farmParcels->count() > 0)
    <div class="section">
        <div class="section-title">VII. Farm Parcels ({{ $enrollment->farmParcels->count() }} Total)</div>
        <div class="section-content">
            @foreach($enrollment->farmParcels as $parcel)
            <div class="parcel-card">
                <div class="parcel-header">
                    Parcel #{{ $loop->iteration }}: {{ $parcel->barangay }}, {{ $parcel->municipality }}
                </div>
                <div class="parcel-content">
                    <div class="form-grid">
                        <div class="form-grid-item" style="width: 40%;">
                            <span class="form-grid-label">Total Farm Area:</span>
                            <span class="form-grid-value"><strong>{{ $parcel->total_farm_area_ha }}
                                    hectares</strong></span>
                        </div>
                        <div class="form-grid-item" style="width: 35%;">
                            <span class="form-grid-label">Ownership Type:</span>
                            <span class="form-grid-value">{{ ucfirst(str_replace('_', ' ', $parcel->ownership_type ??
                                'N/A')) }}</span>
                        </div>
                        @if($parcel->ownership_document_no)
                        <div class="form-grid-item" style="width: 25%;">
                            <span class="form-grid-label">Document No:</span>
                            <span class="form-grid-value">{{ $parcel->ownership_document_no }}</span>
                        </div>
                        @endif
                    </div>

                    @if($parcel->items && $parcel->items->count() > 0)
                    <div style="margin-top: 10px;">
                        <strong style="font-size: 8.5pt; color: #1a5f3f;">Crops & Commodities:</strong>
                    </div>
                    @foreach($parcel->items as $item)
                    <div class="parcel-item">
                        <strong>{{ $item->name }}</strong>
                        <span class="text-muted">({{ ucfirst($item->kind) }})</span>

                        @if($item->size_ha || $item->num_of_head || $item->farm_type || $item->is_organic_practitioner)
                        <div class="parcel-meta">
                            @if($item->size_ha)
                            <span class="badge">{{ $item->size_ha }} ha</span>
                            @endif
                            @if($item->num_of_head && $item->kind !== 'crop')
                            <span class="badge">{{ $item->num_of_head }} heads</span>
                            @endif
                            @if($item->farm_type)
                            <span class="badge badge-warning">{{ $item->farm_type }}</span>
                            @endif
                            @if($item->is_organic_practitioner)
                            <span class="badge badge-success">Organic Practitioner</span>
                            @endif
                        </div>
                        @endif

                        @if($item->remarks)
                        <div style="margin-top: 4px;">
                            <em>{{ $item->remarks }}</em>
                        </div>
                        @endif
                    </div>
                    @endforeach
                    @endif
                </div>
            </div>
            @endforeach
        </div>
    </div>
    @endif

    <!-- Footer -->
    <div class="footer">
        <p><strong>Department of Agriculture - Claveria, Cagayan</strong></p>
        <p>Registry System for Basic Sectors in Agriculture (RSBSA)</p>
        <p>Document generated on {{ now()->format('F d, Y \a\t g:i A') }}</p>
    </div>
</body>

</html>